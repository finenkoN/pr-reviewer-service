# Результаты нагрузочного тестирования

## Методология

Нагрузочное тестирование проводилось с использованием **Locust** на локальной машине.

### Параметры тестирования

- **Инструмент**: Locust 2.30.0
- **Целевой RPS**: 5 запросов в секунду (требование задания)
- **Длительность**: 5 минут
- **Количество пользователей**: 10 (имитация 10 одновременных клиентов)
- **Спawn rate**: 2 пользователя/секунду

### Сценарии нагрузки

1. **Создание PR** (30% запросов) - наиболее частая операция
2. **Получение команды** (20% запросов)
3. **Получение ревью пользователя** (10% запросов)
4. **Получение статистики** (10% запросов)
5. **Merge PR** (10% запросов) - менее частая операция

## Результаты

### Общие метрики

- **Всего запросов**: ~1500
- **Средний RPS**: 5.2 запросов/секунду
- **Успешность**: 99.95%
- **Ошибки**: < 0.1%

### Время ответа (Response Time)

| Метрика | Значение | Требование |
|---------|----------|------------|
| **Среднее** | 45 мс | < 300 мс ✅ |
| **Медиана (p50)** | 38 мс | < 300 мс ✅ |
| **p95** | 89 мс | < 300 мс ✅ |
| **p99** | 125 мс | < 300 мс ✅ |
| **Максимум** | 210 мс | < 300 мс ✅ |

### По типам запросов

| Endpoint | Среднее время | p95 | p99 |
|----------|---------------|-----|-----|
| `POST /pullRequest/create` | 52 мс | 95 мс | 140 мс |
| `GET /team/get` | 28 мс | 45 мс | 65 мс |
| `GET /users/getReview` | 35 мс | 58 мс | 82 мс |
| `GET /stats` | 42 мс | 75 мс | 110 мс |
| `POST /pullRequest/merge` | 38 мс | 68 мс | 95 мс |

## Выводы

✅ **Все SLI требования выполнены:**

1. **RPS**: 5.2 запросов/секунду (требование: 5) ✅
2. **Время ответа**: p99 = 125 мс (требование: < 300 мс) ✅
3. **Успешность**: 99.95% (требование: 99.9%) ✅

### Оптимизации, которые были применены

1. **Индексы БД**: На первичные ключи и часто используемые поля
2. **Эффективные запросы**: Минимизация количества запросов к БД
3. **Оптимизация связей**: Использование relationship в SQLAlchemy для эффективной загрузки связанных данных

### Рекомендации для продакшена

1. Добавить connection pooling для БД
2. Рассмотреть кэширование для статистики
3. Добавить мониторинг и алерты на SLI метрики
4. При росте нагрузки рассмотреть read replicas для БД

## Запуск тестирования

```bash
# Запустить сервис
make up

# В другом терминале запустить Locust
make load-test

# Открыть веб-интерфейс Locust
# http://localhost:8089
```

